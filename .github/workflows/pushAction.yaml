on: push


jobs:
  build:
    name: Build
    runs-on: ubuntu-18.04

    continue-on-error: true

    steps:
      # Log The Contexts
      # - run: "echo 'Github: ${{ toJSON(github) }}'"
      # - run: "echo 'Env: ${{ toJSON(env) }}'"
      # - run: "echo 'Job: ${{ toJSON(job) }}'"
      # - run: "echo 'Steps: ${{ toJSON(steps) }}'"
      # - run: "echo 'Runner: ${{ toJSON(runner) }}'"
      # - run: "echo 'Secrets: ${{ toJSON(secrets) }}'"
      # - run: "echo 'Strategy: ${{ toJSON(strategy) }}'"
      # - run: "echo 'Matrix: ${{ toJSON(matrix) }}'"
      # - run: "echo 'Needs: ${{ toJSON(needs) }}'"

      - name: "checkout"
        uses: actions/checkout@v2

      - name: "Setup Node"
        uses: actions/setup-node@v1
        with:
          node-version: '14'

      - name: "Install Dependencies"
        run: "npm ci"

      - name: "build"
        id: build
        run: "npm run build"
        continue-on-error: true

      - name: Steps
        run: "echo ${{ toJSON(steps) }}"

    outputs:
      status: "statss"

  sendMessage:
    name: Send Message
    runs-on: ubuntu-18.04

    needs: build

    steps:
      # - name: Needs
      #   run: "echo ${{ toJSON(needs) }}"
      - name: "sendmmm"
        env:
          MSG: '{
            "title": "${{ github.event.pusher.name }} Pushed",
            "description": "In repository: ${{ github.event.repository.html_url }}",
            "fields": [
              {"name": "Status", "value": "${{ job.status }}"}
            ]
          }'
        run: 'curl -H "Content-Type: application/json" -d "{\"embeds\": [$MSG]}" -X POST https://discord.com/api/webhooks/779046008684412979/UaQqJmOHg7nwqNAupSc04_hiE-Hmrk61VwTwtgMEnuLcXFe95S29omkXHE-ikOzNk5bZ'